components:
  responses:
    BasicApiResponse:
      content:
        application/json:
          schema:
            $ref: '#components/schemas/BasicApiResponse'

  schemas:
    ApiResponse:
      type: object
      properties:
        message:
          type: string
        data:
          description: Response data (type varies by endpoint)
      additionalProperties: false

    ApiResponseError:
      allOf:
        - $ref: '#/components/schemas/ApiResponse'
        - type: object
          properties:
            message:
              type: string
              example: 'An error occurred'
            data:
              type: 'null'
              example: null

    ImageUri:
      type: string
      description: |
        Either a filename to search in the backend's own file store, or an URL to an image in an external storage server.
        May be used for game images or small icons.

    Franchise:
      type: object
      description: Set of games related by a common series or character
      properties:
        id:
          type: number
        name:
          type: string
        games:
          type: array
          items:
            $ref: '#/components/schemas/Game'

    Game:
      type: object
      description: A video game entity with all its associated information
      properties:
        id:
          type: number
          description: Unique identifier for the game
        title:
          type: string
          minLength: 1
          maxLength: 180
          description: Title of the game (must be unique)
        synopsis:
          type: string
          minLength: 10
          maxLength: 255
          description: A brief description of the game
          nullable: true
        releaseDate:
          type: string
          format: date
          description: Release date of the game
          nullable: true
        portrait:
          $ref: '#/components/schemas/ImageUri'
          description: Portrait/cover image of the game
          nullable: true
        banner:
          $ref: '#/components/schemas/ImageUri'
          description: Banner image of the game
          nullable: true
        cumulativeRating:
          type: number
          description: |
            The cumulative rating of the game from all user reviews.
            This is the sum of all review scores.
          readOnly: true
        reviewCount:
          type: number
          description: Total number of reviews for this game
          readOnly: true
        tags:
          type: array
          items:
            $ref: '#/components/schemas/Tag'
          description: Tags associated with this game
        platforms:
          type: array
          items:
            $ref: '#/components/schemas/Platform'
          description: Platforms where this game is available
        shops:
          type: array
          items:
            $ref: '#/components/schemas/Shop'
          description: Shops where this game can be purchased
        studios:
          type: array
          items:
            $ref: '#/components/schemas/Studio'
          description: Studios that developed or published this game
        franchise:
          $ref: '#/components/schemas/Franchise'
          description: Franchise this game belongs to
          nullable: true
        reviews:
          type: array
          items:
            $ref: '#/components/schemas/Review'
          description: User reviews for this game
      required:
        - id
        - title
        - cumulativeRating
        - reviewCount
      example:
        id: 1
        title: 'The Witcher 3: Wild Hunt'
        synopsis: 'An open-world action RPG set in a fantasy universe filled with meaningful choices and impactful consequences.'
        releaseDate: '2015-05-19'
        portrait: 'witcher3-portrait.jpg'
        banner: 'witcher3-banner.jpg'
        cumulativeRating: 450.5
        reviewCount: 100
        tags: []
        platforms: []
        shops: []
        studios: []
        franchise: null
        reviews: []

    Tag:
      type: object
      description: |
        A tag that can be associated with games to categorize them.
        It may relate to genres, themes, or technical aspects of the games.
      properties:
        id:
          type: number
          description: Unique identifier for the tag
        name:
          type: string
          description: Name of the tag (must be unique)
        description:
          type: string
          description: Description of what this tag represents
      required:
        - id
        - name
        - description
      example:
        id: 1
        name: 'Action'
        description: 'Fast-paced games with combat and adventure elements'
        games: []

    Platform:
      type: object
      description: |
        A hardware platform or gaming system that can run games.
        Examples include consoles, PC, mobile devices, etc.
      properties:
        id:
          type: number
          description: Unique identifier for the platform
        name:
          type: string
          description: Name of the platform (must be unique)
        img:
          $ref: '#/components/schemas/ImageUri'
          description: Image representing the platform (logo or icon)
        games:
          type: array
          items:
            $ref: '#/components/schemas/Game'
          description: Games available on this platform
      required:
        - id
        - name
      example:
        id: 1
        name: 'PlayStation 5'
        img: 'ps5-logo.png'
        games: []

    Studio:
      type: object
      description: |
        A game development studio or publisher that creates or distributes games.
        Can be a developer, publisher, or both.
      properties:
        id:
          type: number
          description: Unique identifier for the studio
        name:
          type: string
          description: Name of the studio (must be unique)
        type:
          type: string
          enum: ['Developer', 'Publisher', 'Both']
          description: Type of studio - Developer, Publisher, or Both
        site:
          type: string
          format: uri
          description: Official website URL of the studio (must be unique)
        games:
          type: array
          items:
            $ref: '#/components/schemas/Game'
          description: Games developed or published by this studio
      required:
        - id
        - name
        - type
        - site
      example:
        id: 1
        name: 'Nintendo'
        type: 'Both'
        site: 'https://www.nintendo.com'
        games: []

    Shop:
      type: object
      description: |
        A digital storefront or marketplace where games can be purchased or downloaded.
        Examples include Steam, Epic Games Store, PlayStation Store, etc.
      properties:
        id:
          type: number
          description: Unique identifier for the shop
        name:
          type: string
          description: Name of the shop (must be unique)
        site:
          type: string
          format: uri
          description: Official website URL of the shop (must be unique and end with .com)
        games:
          type: array
          items:
            $ref: '#/components/schemas/Game'
          description: Games available in this shop
      required:
        - id
        - name
        - site
      example:
        id: 1
        name: 'Steam'
        site: 'https://store.steampowered.com'
        games: []

    Review:
      type: object
      description: |
        A user review for a game, including rating, title, body text, and optional suggested tags.
        Each user can only have one review per game.
      properties:
        id:
          type: number
          description: Unique identifier for the review
        author:
          $ref: '#/components/schemas/User'
          description: The user who wrote this review
        game:
          $ref: '#/components/schemas/Game'
          description: The game being reviewed
        score:
          type: number
          format: decimal
          minimum: 0
          maximum: 5
          multipleOf: 0.5
          description: Rating score from 0 to 5 (rounded to nearest 0.5)
        title:
          type: string
          description: Optional title for the review
          nullable: true
        body:
          type: string
          description: Optional detailed review text
          nullable: true
        createdAt:
          type: string
          format: date-time
          description: When the review was created
          readOnly: true
      required:
        - id
        - author
        - game
        - score
        - createdAt
      example:
        id: 1
        author:
          id: 1
          nick: 'gamer123'
          profile_img: 'profile1.jpg'
        game:
          id: 1
          title: 'The Witcher 3'
        score: 4.5
        title: 'Amazing RPG Experience'
        body: 'One of the best RPGs I have ever played. Great story and characters.'
        createdAt: '2024-01-15T10:30:00Z'

    User:
      type: object
      description: A registered user account
      properties:
        id:
          type: number
          description: Unique identifier for the user
        nick:
          type: string
          minLength: 3
          maxLength: 30
          description: Username (must be unique)
        email:
          type: string
          format: email
          description: User's email address (hidden in responses)
          writeOnly: true
        profile_img:
          $ref: '#/components/schemas/ImageUri'
          description: User's profile picture
          nullable: true
        bio_text:
          type: string
          description: User's biography text
          nullable: true
        linked_accounts:
          type: array
          items:
            type: string
          description: User's linked social media accounts
          nullable: true
        is_admin:
          type: boolean
          description: Whether the user has admin privileges
          readOnly: true
        likedTags:
          type: array
          items:
            $ref: '#/components/schemas/Tag'
          description: Tags liked by the user
        playlists:
          type: array
          items:
            $ref: '#/components/schemas/Playlist'
          description: Playlists created by the user
        reviews:
          type: array
          items:
            $ref: '#/components/schemas/Review'
          description: Reviews written by the user
      required:
        - id
        - nick
        - is_admin
      example:
        id: 1
        nick: 'gamer123'
        profile_img: 'profile1.jpg'
        bio_text: 'Passionate gamer and reviewer'
        linked_accounts: ['@gamer123_twitter']
        is_admin: false
        likedTags: []
        playlists: []
        reviews: []

    Playlist:
      type: object
      description: A user-created collection of games
      properties:
        id:
          type: number
          description: Unique identifier for the playlist
        name:
          type: string
          minLength: 1
          maxLength: 100
          description: Name of the playlist (must be unique)
        description:
          type: string
          minLength: 1
          maxLength: 255
          description: Description of the playlist
        isPrivate:
          type: boolean
          description: Whether the playlist is private (visible only to owner) or public
        owner:
          $ref: '#/components/schemas/User'
          description: User who created and owns this playlist
        games:
          type: array
          items:
            $ref: '#/components/schemas/Game'
          description: Games included in this playlist
      required:
        - id
        - name
        - description
        - isPrivate
        - owner
      example:
        id: 1
        name: 'My Favorite RPGs'
        description: 'A collection of the best role-playing games I have played'
        isPrivate: false
        owner:
          id: 1
          nick: 'gamer123'
        games: []

  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token for authentication

  tags:
    - name: Franchise
      description: Game series
    - name: Game
      description: Individual games
    - name: Platform
      description: Hardware platforms
    - name: Playlist
      description: User-created game lists
    - name: Review
      description: User reviews and ratings
    - name: Shop
      description: Game stores
    - name: Studio
      description: Game development studios and publishers
    - name: Tag
      description: Game categorization tags
    - name: User
      description: User accounts and profiles
